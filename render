services:
  - type: web
    name: oanda-dashboard
    env: python
    plan: starter
    buildCommand: pip install -r requirements.txt
    startCommand: streamlit run dashboard.py --server.address 0.0.0.0 --server.port $PORT --server.headless true
    envVars:
      - key: OANDA_HOST
        sync: false
      - key: OANDA_ACCOUNT
        sync: false
      - key: OANDA_TOKEN
        sync: false
      - key: INSTRUMENTS
        value: EUR_USD,GBP_USD
      - key: NEWS_INTERVAL_SEC
        value: "180"
      - key: NEWS_COOLDOWN_MIN
        value: "30"
      - key: DAILY_LOSS_CAP_PCT
        value: "2.0"
      - key: RISK_PER_TRADE_PCT
        value: "0.25"
      - key: TP_PIPS
        value: "50"
      - key: SL_PIPS
        value: "25"

  - type: worker
    name: oanda-news-bot
    env: python
    plan: starter
    buildCommand: pip install -r requirements.txt
    startCommand: python -u news_sentiment.py
    envVars:
      - key: OANDA_HOST
        sync: false
      - key: OANDA_ACCOUNT
        sync: false
      - key: OANDA_TOKEN
        sync: false
      - key: INSTRUMENTS
        value: EUR_USD,GBP_USD
      - key: NEWS_INTERVAL_SEC
        value: "180"
      - key: NEWS_COOLDOWN_MIN
        value: "30"
      - key: DAILY_LOSS_CAP_PCT
        value: "2.0"
      - key: RISK_PER_TRADE_PCT
        value: "0.25"
      - key: TP_PIPS
        value: "50"
      - key: SL_PIPS
        value: "25"
